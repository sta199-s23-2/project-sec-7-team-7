---
title: "Project title"
subtitle: "Report"
format: html
editor: visual
execute:
  echo: true
---

# Introduction and data

We found the data set on kaggle, but the data was initially collected by the Hungarian Institute of Cardiology, and the Cleveland Clinic Foundation. This synthesis of information was donated to the University of California at Irvine's Machine learning Repository in 1988. Some relevant variables include:

1.  age: (Age of the patient in years
2.  dataset: (place of study)
3.  sex: (Male/Female)
4.  cp: chest pain type (\[typical angina, atypical angina, non-anginal, asymptomatic\])
5.  trestbps: resting blood pressure (resting blood pressure (in mm Hg on admission to the hospital))
6.  chol: (serum cholesterol in mg/dl)
7.  fbs: (if fasting blood sugar \> 120 mg/dl)
8.  restecg: (resting electrocardiographic results)\
    \-- Values: \[normal, stt abnormality, lv hypertrophy\]
9.  thalach: maximum heart rate achieved
10. exang: exercise-induced angina (True/ False)
11. oldpeak: ST depression induced by exercise relative to rest
12. slope: the slope of the peak exercise ST segment
13. ca: number of major vessels (0-3) colored by fluoroscopy
14. thal: \[normal; fixed defect; reversible defect\]
15. num: the predicted attribute 0 means no heart disease, and 1-4 is the degree to which they have it. In this case, 1-4 will be classified as 1, as we are not concerned with the degree to which they have heart disease, just that they have it.

# Methodology

```{r}
#| label: load-data
heart_disease <- read_csv("data/heart_disease_uci.csv")
glimpse(heart_disease)
```

```{r}
#| label: change-response-var

heart_disease <- heart_disease |>
  mutate(num = ifelse((num >= "1"), "1", "0"))
```

```{r}
#| label: heart-disease-based-on-sex
  heart_disease |>
  ggplot(
    aes(x = sex, fill = num)) + 
    geom_bar(position = "fill") +
  labs(title = "Males vs Females in Heart Disease Rates", 
       x = "Gender",
       y = "Proportion", 
       fill = "Whether or not they Have Heart Disease") +
  theme_classic()

```

```{r}
#| label: heart-disease-based-on-age
  heart_disease |>
    ggplot(
      aes(x = age, fill = if_else(num == 1, "Yes", "No"))
      ) +
    geom_histogram(position = "fill", bins = 30) +
    labs(title = "Heart Disease Rates By Age",
         x = "Age",
         y = "Proportion",
         fill = "Heart Disease Presence") +
    theme_classic()
```

As age increases, the proportion of people with heart disease increases.

```{r}
#| label: heart-disease-based-on-cholesterol
  
heart_disease |>
  filter(chol != 0) |>
  ggplot(
    aes(x = chol, fill = if_else(num == 1, "Yes", "No"))
    ) +
  geom_histogram(position = "fill", bins = 20) +
  labs(title = "Heart Disease Rates By Cholesterol",
       x = "Cholesterol Levels",
       y = "Proportion",         
       fill = "Heart Disease Presence") +
  theme_classic()
```

As cholesterol increases, heart disease rates increase. We filtered out entries with chol = 0 because that is not possible.

```{r}
#| label: heart-disease-based-on-blood-sugar
  
heart_disease |>
  filter(!is.na(fbs)) |>
  ggplot(
    aes(x = fbs, fill = if_else(num == 1, "Yes", "No"))
    ) +
  geom_bar(position = "fill") +
  labs(title = "Heart Disease Rates By Blood Sugar",
       x = "Blood Sugar Levels Above 150",
       y = "Proportion",         
       fill = "Heart Disease Presence") +
  theme_classic()
```

People with fasting blood sugar above 150 are move likely to have heart disease than those with fbs below 150.

```{r}
#| label: heart-disease-based-on-blood-pressure
  
heart_disease |>
  filter(trestbps != 0) |>
  ggplot(
    aes(x = trestbps, fill = if_else(num == 1, "Yes", "No"))
    ) +
  facet_wrap(~sex) + 
  geom_histogram(position = "fill", bins = 30) +
  labs(title = "Heart Disease Rates By Blood Pressure",
       x = "Blood Pressure",
       y = "Proportion",         
       fill = "Heart Disease Presence") +
  theme_classic()
```

For females, as blood pressure increases past about 115, higher bp is correlated with higher rates of heart disease. Below 115, lower bp is correlated with higher rates of heart disease. For males, There is not as strong a correlation between blood pressure and heart disease rates. We filtered would bp = 0 because that is not possible and a filler of not recorded data.

# Results
